<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catatan Kendaraan</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Catatan Kendaraan</h1>
        <div class="form-container">
            <form id="noteForm">
                </form>
        </div>

        <h2>Daftar Catatan</h2>
        <div class="table-wrapper">
            <table id="noteTable">
                <thead>
                    <tr>
                        <th>Kode Lambung</th>
                        <th>Plat Kendaraan</th>
                        <th>Nama Driver</th>
                        <th>Waktu Checker</th>
                        <th>Nomor DO</th>
                        <th>Produk</th>
                        <th>PIT Asal</th>
                        <th>Tanggal</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>

        <button id="exportButton">Export to Excel</button>
    </div>

    <script src="xlsx.full.min.js"></script>
    <script>
        let notesData = [];

        function updateTable() {
            const tableBody = document.getElementById('noteTable').tbody;
            tableBody.innerHTML = '';

            notesData.forEach((note, index) => {
                const row = tableBody.insertRow();
                const cells = [];
                for (const key in note) {
                    const cell = row.insertCell();
                    cell.textContent = note[key];
                    cells.push(cell);
                }

                const editButton = document.createElement('button');
                editButton.textContent = 'Edit';
                editButton.onclick = () => editNote(index);
                cells[cells.length - 1].appendChild(editButton);
            });
        }

        function addNote(note) {
            notesData.push(note);
            updateTable();
        }

        function editNote(index) {
            const note = notesData[index];
            // Populate form fields with note data
            document.getElementById('kode_lambung').value = note.kode_lambung;
            // ... populate other fields
            document.getElementById('updateButton').style.display = 'block';
            editRowIndex = index;
        }

        document.getElementById('noteForm').addEventListener('submit', (event) => {
            event.preventDefault();

            const note = {
                kode_lambung: document.getElementById('kode_lambung').value,
                // ... other fields
            };

            if (editRowIndex !== -1) {
                notesData[editRowIndex] = note;
                editRowIndex = -1;
                document.getElementById('updateButton').style.display = 'none';
            } else {
                addNote(note);
            }

            document.getElementById('noteForm').reset();
            updateTable();
        });

        // ... other functions
    </script>
</body>
</html>
